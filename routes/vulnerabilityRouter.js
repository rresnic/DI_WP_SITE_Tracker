const {Router} = require("express");
const router = Router();
const vulnerabilityController = require ("../controllers/vulnerabilityController.js");
const { verifyToken } = require("../middlewares/verifyToken.js");
const { checkUserRole } = require("../middlewares/checkUserRole.js");

router.post("/new", vulnerabilityController.addVulnerability);
router.put("/refresh", verifyToken, checkUserRole("admin") , vulnerabilityController.refreshVulnerabilitiesAPI)
router.get("/all", vulnerabilityController.getVulnerabilities)
router.get("/:id", vulnerabilityController.getUserVulnerabilities)
module.exports = router;